<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</title>
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, onValue, update, set } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCn_JhHcx-OXd_zoxwGqSxIfIwrNLBBYgI",
  authDomain: "error-13b42.firebaseapp.com",
  databaseURL: "https://error-13b42-default-rtdb.firebaseio.com",
  projectId: "error-13b42",
  storageBucket: "error-13b42.firebasestorage.app",
  messagingSenderId: "255234583788",
  appId: "1:255234583788:web:bba2a1aba01d68b2c189c9"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
onValue(ref(db, "requests"), (snapshot)=>{
    const data = snapshot.val();
    let html = "";
    for(let id in data){
        html += `
        <div style="background:#222;padding:10px;margin:10px">
            <p>ğŸ‘¤ ${data[id].userId}</p>
            <p>ğŸ“© ${data[id].message}</p>
        </div>`;
    }
    document.getElementById("Ø·Ù„Ø¨Ø§Øª").innerHTML = html;
});

// Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
onValue(ref(db, "users"), (snapshot)=>{
    const data = snapshot.val();
    let html = "";
    for(let id in data){
        html += `
        <div style="background:#333;padding:10px;margin:10px">
            ${id}
            <button onclick="activate('${id}')">ØªÙØ¹ÙŠÙ„</button>
            <button onclick="deactivate('${id}')">ØªØ¹Ø·ÙŠÙ„</button>
        </div>`;
    }
    document.getElementById("users").innerHTML = html;
});

window.activate = function(id){
    update(ref(db, "users/" + id), {active:true});
}

window.deactivate = function(id){
    update(ref(db, "users/" + id), {active:false});
}

// Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø°Ø§Ø¹Ø©
window.sendBroadcast = function(){
    const msg = document.getElementById("bmsg").value;
    set(ref(db, "broadcast"), {message: msg});
    alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø°Ø§Ø¹Ø©");
}

</script>
</head>

<body style="background:#111;color:white;font-family:sans-serif">

<h2>Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</h2>

<h3>ğŸ“¢ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø°Ø§Ø¹Ø©</h3>
<input id="bmsg" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø±Ø³Ø§Ù„Ø©">
<button onclick="sendBroadcast()">Ø¥Ø±Ø³Ø§Ù„</button>

<h3>ğŸ“© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
<div id="Ø·Ù„Ø¨Ø§Øª"></div>

<h3>ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
<div id="users"></div>

</body>
</html>